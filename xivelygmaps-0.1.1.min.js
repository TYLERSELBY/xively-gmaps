// xively-gmaps
// version 0.1.1
// (c) 2013 Xively Ltd, a LogMeIn company [baself@gmail.com]
// http://xively.github.com/xively-gmaps/
// released under the MIT license
var xivelyGmaps=function(e){"use strict";var t,n="https://api.xively.com/v2/",r="wss://api.xively.com:8080/",i,s,o,u="#map-canvas";t={setKey:function(e){xively.setKey(e)},setApiEndpoint:function(e){xively.setEndpoint(e||n)},setWsEndpoint:function(e){xively.setWSEndpoint()},subscribe:function(e){var t=this;xively.feed.get(e,function(e){t.renderMap(e)});xively.feed.subscribe(e,function(e,n){t.renderMap(n)})},setMapElement:function(e){u=e},renderMap:function(t){var n=this;var r=t.location;if(t&&n.checkValidLocation(r)){var a=new google.maps.LatLng(r.lat,r.lon);var f="Feed id: "+t.id+"\n"+"Latitude: "+r.lat+"\n"+"Longitude: "+r.lon;if(typeof i==="undefined"){var l={center:a,zoom:13,mapTypeId:google.maps.MapTypeId.ROAD_MAP};s=new google.maps.Map(e(u)[0],l);n.setMarker(a,f)}else if(r.lat!==i.lat||r.lon!==i.lon){if(o){o.setMap(null)}n.setMarker(a);s.setCenter(a,f)}i=r}else{e(u).html("Awaiting Location Data")}},checkValidLocation:function(e){return e&&e.lat&&e.lon},setMarker:function(e,t){o=new google.maps.Marker({position:e,map:s,zoom:13,title:t})}};return t}(jQuery)
